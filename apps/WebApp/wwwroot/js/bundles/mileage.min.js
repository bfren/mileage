function showAlert(n,t){(message.find(".icon").html(alertIcons[n]),message.find(".text").text(t),message.find(".countdown").text(""),message.show(),clearTimeout(alertTimeout),n!="error")&&updateAlert(5)}function updateAlert(n){if(n==0){closeAlert();return}message.find(".countdown").text(n);alertTimeout=setTimeout(()=>updateAlert(n-1),1e3)}function closeAlert(){message.fadeOut()}function showAlertsOnLoad(){}function setupTokenModals(){$(".token > a").click(function(){var n=$(this).data("edit"),t=$(this).data("replace");openModal(n,t)})}function openModal(n,t){showAlert("info","Please wait...");console.log("Loading modal from: "+n);$("#edit").load(n,function(){var r=$(this).find("form"),n,i;r.attr("data-replace",t);closeAlert();n=document.getElementById("edit-modal");i=new bootstrap.Modal(n);i.show();setupModalSave();setupAjaxSubmit()})}function setupModalSave(){$("#edit .btn-save").click(function(){$("#edit form").submit()})}function handleResult(n){showAlert(n.message.type,n.message.text);n.redirectTo&&(showAlert("info","Redirecting, please wait..."),window.location.href=n.redirectTo)}function setupAjaxSubmit(){$("form").submit(function(n){n.preventDefault();showAlert("info","Please wait...");var t=$(this),r=t.attr("action"),i=t.data("replace"),u=t.serialize();$.ajax({url:r,method:"POST",data:u}).done(function(n){i?n?($("#"+i).replaceWith(n),showAlert("success","Saved."),setupTokenModals()):showAlert("error","Unable to save, please try again."):n&&handleResult(n)}).fail(function(n){n&&n.responseJSON?handleResult(n.responseJSON):showAlert("error","Something went wrong, please try again.")})})}const alertIcons={close:$("<i/>").addClass("fa-solid fa-xmark"),info:$("<i/>").addClass("fa-solid fa-circle-info"),success:$("<i/>").addClass("fa-solid fa-check"),warning:$("<i/>").addClass("fa-solid fa-triangle-exclamation"),error:$("<i/>").addClass("fa-solid fa-ban"),edit:$("<i/>").addClass("fa-solid fa-circle-plus"),"delete":$("<i/>").addClass("fa-solid fa-circle-minus"),complete:$("<i/>").addClass("fa-solid fa-circle-check"),save:$("<i/>").addClass("fa-solid fa-ban")},message=$(".statusbar .message");var alertTimeout=0;ready(function(){message.click(function(){closeAlert()})});ready(showAlertsOnLoad);ready(setupTokenModals);ready(setupAjaxSubmit);