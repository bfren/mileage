function showAlert(n,t,i){(message.find(".icon").html(alertIcons[n]),message.find(".text").text(t),message.find(".countdown").text(""),message.show(),clearTimeout(alertTimeout),n==alertTypes.error||i)||updateAlert(5)}function showPleaseWaitAlert(){showAlert(alertTypes.info,"Please wait...",!0)}function updateAlert(n){if(n==0){closeAlert();return}message.find(".countdown").text(n);alertTimeout=setTimeout(()=>updateAlert(n-1),1e3)}function closeAlert(){message.fadeOut()}function showAlertsOnLoad(){}function openModal(n,t,i,r,u){showPleaseWaitAlert();$(n).load(t,function(){var t=$(this).find("form");t.attr("data-replace",i);t.attr("data-replace-contents",r);var f=$(this),e=$(this).find(".modal").attr("id"),n=document.getElementById(e);n.addEventListener("shown.bs.modal",()=>$(".modal-select").focus());n.addEventListener("hide.bs.modal",()=>f.fadeOut("fast"));f.fadeIn("fast",()=>closeAlert());modal=new bootstrap.Modal(n);modal.show();u&&u()})}function openDeleteModal(n,t){openModal("#delete",n,t,!0)}function setupDeleteModalSave(){$("body").on("click","#delete .btn-delete",function(){$("#delete form").submit();modal.hide()})}function openEditModal(n,t){openModal("#edit",n,t,!1,()=>setupEditModalSearch())}function setupEditModalSearch(){var n=$("#edit .btn-add");n.hide();$("#list-filter").keydown(function(t){t.keyCode==13&&(t.preventDefault(),n.click())});$("#list-filter").keyup(function(){var t=$(this).val();t?n.text("Add: "+t).show():n.text("").hide();$("#list-items .list-item").filter(function(){var n=$(this).data("text").indexOf(t.toLowerCase())>-1;$(this).toggle(n)})})}function setupEditModalSave(){$("body").on("click","#edit .btn-save",function(){$("#edit form").submit();modal.hide()})}function setupTokenEditModals(){$("body").on("click",".token > a",function(){var n=$(this).data("edit"),t=$(this).data("replace");openEditModal(n,t)})}function handleResult(n){showAlert(n.message.type,n.message.text);n.redirectTo&&(showAlert(alertTypes.info,"Redirecting...",!0),window.location.href=n.redirectTo)}function setupSettingsTabs(){$("#settingsButtons .nav-link").click(function(){var n=$(this).data("bs-target");loadSettingsTab(n)})}function loadSettingsTab(n){var t=$(n),i=t.data("src");showPleaseWaitAlert();t.load(i,()=>closeAlert())}function loadSaveForm(n,t,i){i.preventDefault();var r=t.data("load");showPleaseWaitAlert();$("#save-"+n).load(r,()=>closeAlert())}function setupReloadFormOnCancel(n,t,i){$(n).on("click",".btn-cancel",function(n){loadSaveForm(t,i,n)})}function setupSaveFormOnEnter(n){$(n).on("keydown","input",function(t){t.keyCode==13&&(t.preventDefault(),$(n).find(".btn-save").click())})}function checkDeleteItem(n,t){t.preventDefault();var i=n.data("delete"),r=n.data("replace");openDeleteModal(i,r)}function setupAjaxSubmit(){$("body").on("submit","form",function(n){n.preventDefault();showPleaseWaitAlert();var t=$(this),i=t.data("replace"),r=t.data("replace-contents");$.ajax({url:t.attr("action"),method:"POST",data:t.serialize()}).done(function(n,t,u){if(u.responseJSON){handleResult(u.responseJSON);return}if(n&&i){var f=$("#"+i);r?f.html(n):f.replaceWith(n);showAlert(alertTypes.success,"Done.");return}showAlert(alertTypes.warning,"Something went wrong, refreshing the page...",!0);location.reload()}).fail(function(n){if(n&&n.responseJSON){handleResult(error.responseJSON);return}showAlert(alertTypes.error,"Something went wrong, please try again.")})})}var alertTimeout,modal;const alertIcons={close:$("<i/>").addClass("fa-solid fa-xmark"),info:$("<i/>").addClass("fa-solid fa-circle-info"),success:$("<i/>").addClass("fa-solid fa-check"),warning:$("<i/>").addClass("fa-solid fa-triangle-exclamation"),error:$("<i/>").addClass("fa-solid fa-ban"),edit:$("<i/>").addClass("fa-solid fa-circle-plus"),"delete":$("<i/>").addClass("fa-solid fa-circle-minus"),complete:$("<i/>").addClass("fa-solid fa-circle-check"),save:$("<i/>").addClass("fa-solid fa-ban")},alertTypes={info:"info",success:"success",warning:"warning",error:"error"},message=$(".statusbar .message");alertTimeout=0;ready(()=>message.click(()=>closeAlert()));ready(showAlertsOnLoad);ready(setupDeleteModalSave);ready(setupEditModalSave);ready(setupTokenEditModals);ready(setupSettingsTabs);ready(setupAjaxSubmit);